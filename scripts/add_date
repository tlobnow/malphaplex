rename_with_date_suffix() {
    # Argument: Full path to the directory to be renamed
    local ITEM_PATH="$1"

    # Check if the path was provided
    if [ -z "$ITEM_PATH" ]; then
        echo "Error: No directory path provided."
        return 1
    fi

    # Get the directory's base name and its parent directory
    local ITEM_NAME=$(basename "$ITEM_PATH")
    local PARENT_DIR=$(dirname "$ITEM_PATH")

    # Check if the directory exists
    if [ ! -e "$ITEM_PATH" ]; then
        echo "Error: The specified directory does not exist."
        return 1
    fi

    # Check if the directory name already has a date suffix using regex
    if [[ $ITEM_NAME =~ [0-9]{8}_[0-9]{6}$ ]]; then
        echo "The directory already has a date suffix. Skipping."
        return 0
    fi

    # Generate the current date and time suffix
    local suffix=$(date "+%Y%m%d_%H%M%S")
    local NEW_NAME="${ITEM_NAME}_$suffix"
    local NEW_PATH="${PARENT_DIR}/${NEW_NAME}"

    # Rename the specified directory by appending the suffix
    mv "$ITEM_PATH" "$NEW_PATH"

    # Echo the new path so it can be captured by the caller
    echo "$NEW_PATH"
}
